---
title: "Final_TSA_Project"
author: "Narissa Jimenez-Petchumrus"
date: "4/12/2022"
output: html_document
---

##Setup

```{r setup, include=FALSE} 
knitr::opts_chunk$set(echo = TRUE,tidy.opts=list(width.cutoff=80), tidy=FALSE) 
```

```{r libraries,include=FALSE}
#Load/install required package here
library(forecast)
library(tseries)
library(readr)
library(lubridate)
library(ggplot2)
library(Kendall)
library(tidyverse)
library(readxl)
library(dplyr)

```

##Import All of the Data

```{r import data,echo=T,results='hide'}
#Import French Science CDD and HDD Data
cdd_hdd <- read_xlsx(path="./Climate Data CDD & HDD.xlsx",sheet="CDD HDD Data",col_names=FALSE,skip=55) 
cdd_hdd

#Import French Science Electricity Data
electric_data <- read_xlsx(path="./French Electric.xlsx",col_names=FALSE, skip=7)
electric_data 

#Import French Science Chilled Water Data
chilled_water <- read_xlsx(path="./CHW Interval Data.xlsx",col_names=TRUE)
chilled_water #need to chop off some columns

#Import French Science Steam Data
steam_data <- read_xlsx(path="./Steam Interval Data.xlsx",col_names=TRUE, sheet="Steam_all_dates")
steam_data #need to chop off some columns

```

##Clean & Wrangle Data

```{r clean data,echo=T,results='hide'}
#reduce data to monthly granularity starting with Jan 2018

#Clean up CDD and HDD Data
cdd_hdd2 <- cdd_hdd[, c(3:5)] %>% as.data.frame()
cdd_hdd2 #42 rows

sapply(cdd_hdd2, class) #check data type
names(cdd_hdd2) <- c('Date','CDD','HDD') #change column names
head(cdd_hdd2)
sapply(cdd_hdd2,class) #check data type again

#Clean Electricity Data
electric_data2 <- electric_data[, c(4:5)] %>% as.data.frame()
electric_data2 #42 rows

sapply(electric_data2, class) #check data type
names(electric_data2) <- c('Date','kWh') #change column names
head(electric_data2)
sapply(electric_data2,class) #check data type again

#Clean Chilled Water Data
chilled_water2 <- chilled_water[, c(1:5,7)] %>% as.data.frame()
chilled_water2

sapply(chilled_water2, class) #check data type
names(chilled_water2) <- c('Date','Month','Day','Year','Time','ton_hrs_cummulative') #change column names
head(chilled_water2)
sapply(chilled_water2,class) #check data type again

#convert 15 min interval to hourly
chilled_hourly <- chilled_water2 %>% 
  filter( !is.na(ton_hrs_cummulative)) %>% 
  group_by(Date,Year,Month,Day) %>% # here we left column with time out
  summarise(hourly_chilled = mean(ton_hrs_cummulative)) #create dataframe with hourly obs

#convert hourly to monthly
chilled_montly <- chilled_hourly %>%
  filter( !is.na(hourly_chilled)) %>% 
  group_by(Date,Year,Month) %>% # here we left column with day out
  summarise(monthly_chilled = mean(hourly_chilled)) #create dataframe with hourly obs






#Clean Steam Data


```





